{% extends 'Base/base.html' %}
{% load static %}

{% block content %}
<div class="container" style="margin-bottom: 3em">
    <div class="row">
        <div class="col py-4" style="height: 50em;">
            <form method="POST" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="row mb-0.5 align-items-center" style="height: 10em; background-color: #e9ecef; border: 1px solid #ced4da;">
                    <div class="col-2" style="height: 100%; display: flex; justify-content: center; align-items: center;">
                        <div style="position: relative; margin-left: 1em">
                            <div style="width: 100px; height: 100px; border-radius: 50%; overflow: hidden;">
                                <img id="profileImage1" src="{% if user.profile.profile_image and user.profile.profile_image.url %}{{ user.profile.profile_image.url }}{% else %}{% static 'Images/default_picture.jpg' %}{% endif %}" class="img-fluid" style="width: 100%; height: 100%; object-fit: cover;">
                            </div>
                            <input type="file" id="imageInput" name="profile_image" accept="image/*" style="display: none;">
                            <label for="imageInput" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background-color: gray; color: white; padding: 5px 10px; border: none; border-radius: 5px; cursor: pointer; font-size: 0.8em;">Upload Image</label>
                        </div>
                    </div>
                    <div class="col-8">
                        <h2>{{ user.first_name }} {{ user.last_name }}</h2>
                    </div>
                    <div class="col-2 text-right">
                        <a href="{% url 'logout' %}" class="btn btn-primary">Logout</a>
                    </div>
                </div>
                <div class="row mb-4" style="height: 8em; background-color: #e9ecef; border: 1px solid #ced4da;">
                    <div class="col-md-6">
                      <h5>Information</h5>
                      <p>Email: <input type="text" name="email" value="{{ user.email }}" placeholder="Email"></p>
                      <p>Phone: <input type="text" name="phone_number" value="{{ form.phone_number.value }}" placeholder="Phone number"></p>
                    </div>
                    <div class="col-md-6">
                      <h5 style="visibility: hidden;">Header</h5>
                      <p>Address: <input type="text" name="address" value="{{ form.street_name.value }}{{ form.house_number.value }}{{ form.postal_code.value }}" placeholder="Street, Number, Postal code"></p>
                      <p>Country: <input type="text" name="country" value="{{ form.country.value }}" placeholder="Country"></p>
                    </div>
                </div>
                <div class="row mb-5" style="height: 20em; background-color: #e9ecef; border: 1px solid #ced4da; width: 102%;">
                    <div class="col">
                        <h5>About Me</h5>
                        <textarea name="bio" id="bio" style="width: 100%; height: 80%; resize: none;" placeholder="Bio">{% if form.bio.value %}{{ form.bio.value }}{% endif %}</textarea>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary" style="visibility: visible; margin-bottom: 4em">Save changes</button>
            </form>
        </div>
    </div>
</div>

<script>
document.getElementById('imageInput').addEventListener('change', function(e) {
    var reader = new FileReader();
    reader.onload = function(e) {
        document.getElementById('profileImage1').src = e.target.result;
        document.getElementById('imageUploadInfo').style.display = 'block';
    }
    reader.readAsDataURL(e.target.files[0]);
});
</script>
{% endblock %}